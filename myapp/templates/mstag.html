{% extends 'base.html' %}
{% load static %}

{% block title %}Ezz Eldin Ahmed | MSTAG{% endblock %}

{% block extra_head %}
<!-- [unchanged SEO metadata block] -->
{% endblock %}

{% block content %}
<!-- Page Header Start --> 
<div class="container-fluid py-5 my-5">
    <div class="container text-center py-5">
        <h1 class="display-4 text-primary mb-4">M.S.T.A.G.</h1>
        <p class="fs-5 text-secondary">Articles and project from brilliant minds that refuse to stay still.</p>
    </div>
</div>
<!-- Page Header End -->

<!-- Blog Start -->
<div class="container-fluid blog py-5 my-5">
    <div class="row g-5 justify-content-center">
        {% for article in articles %}
        <div class="col-lg-6 col-xl-4 wow fadeIn" data-wow-delay=".{{ forloop.counter }}s">
            <div class="blog-item position-relative bg-light rounded overflow-hidden shadow-sm">

                <!-- Article Image -->
                <img src="{{ article.image }}" class="img-fluid w-100 rounded-top" alt="{{ article.title }}">

                <!-- Topic Badge -->
                <span class="position-absolute px-3 py-2 bg-primary text-white rounded" style="top: 10px; left: 10px; font-size: 0.8rem;">
                    {{ article.topic|title }}
                </span>

                <!-- Date Badge -->
                <span class="position-absolute px-3 py-2 bg-dark text-white rounded" style="top: 10px; right: 10px; font-size: 0.8rem;">
                    {{ article.date_published|date:"d M" }}
                </span>

                <!-- Content -->
                <div class="p-4 text-center">
                    <img src="{{ article.author_image }}" class="img-fluid rounded-circle border border-4 border-white mb-3" style="width: 120px; height: 180px;" alt="{{ article.author }}">
                    <h4 class="fw-bold mb-2">{{ article.title }}</h4>
                    <h6 class="text-muted mb-2">By {{ article.author }}</h6>
                    <p class="text-secondary mb-3">{{ article.description }}</p>
                    <a href="{% url 'article_detail' slug=article.slug %}" class="btn btn-outline-primary rounded-pill">Read More</a>
                </div>

                <!-- Share + Comment -->
                <div class="blog-coment d-flex justify-content-between px-4 py-2 border bg-primary rounded-bottom">
                    <a href="#" class="text-white" onclick="toggleShare('{{ article.slug }}'); return false;">
                        <small><i class="fas fa-share me-2 text-secondary"></i>Share</small>
                    </a>
                    <a href="{% url 'article_detail' slug=article.slug %}#comments" class="text-white">
                        <small><i class="fa fa-comments me-2 text-secondary"></i>Comments</small>
                    </a>
                </div>

                <!-- Hidden Share Panel -->
                <div id="share-{{ article.slug }}" class="d-none px-4 py-2 text-center">
                    <!-- Facebook Share -->
                    <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri|cut:'/' }}{% url 'article_detail' slug=article.slug %}" 
                       target="_blank" 
                       class="btn btn-sm btn-primary me-2">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                
                    <!-- Twitter Share -->
                    <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri|cut:'/' }}{% url 'article_detail' slug=article.slug %}" 
                       target="_blank" 
                       class="btn btn-sm btn-info me-2">
                        <i class="fab fa-twitter"></i>
                    </a>
                
                    <!-- Copy to Clipboard -->
                    <button class="btn btn-sm btn-dark" onclick="copyLink('{{ request.scheme }}://{{ request.get_host }}{% url 'article_detail' slug=article.slug %}')">
                        <i class="fas fa-link"></i> Copy
                    </button>
                </div>
            </div>
        </div>
        {% empty %}
        <p class="text-center text-muted">No articles have been posted in MSTAG yet.</p>
        {% endfor %}
    </div>
</div>
<!-- Blog End -->
{% endblock %}

{% block extra_js %}
<script>
function toggleShare(slug) {
    const el = document.getElementById('share-' + slug);
    el.classList.toggle('d-none');
}

function copyLink(url) {
    navigator.clipboard.writeText(url).then(() => {
        alert("Link copied to clipboard!");
    });
}
</script>
{% endblock %}
